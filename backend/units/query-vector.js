const { Pinecone } =  require("@pinecone-database/pinecone");
const dotenv = require('dotenv');
dotenv.config();

const pinecone = new Pinecone({
  apiKey: process.env.PINECONE_API_KEY
});

const index = pinecone.index("viewvie");
//first embedding from video embedding user-output side
//array of floats between 0 - 1, -> [0.5, 0.6, ...]

async function queryVector(vector) {
  const queryResponse = await index.namespace("test")
      .query({
        topK: 1, //returns 1 most similar vector
        vector: vector,
        includeValues: Boolean(1),
        includeMetadata: Boolean(1),
      });

  return queryResponse.matches[0]; // -> {movieName: "Godzilla Minus One"}
}

// queryVector([-0.303261191, 0.333829761, -0.20654285, 0.0783204883, -0.0416801944, -0.245526403, -0.096656464, -0.264421493, 0.880116343, 0.290866613, 0.223719046, -0.164526761, -0.0139278341, 2.533571, -0.259855568, -0.312950283, 0, 0.251467079, -0.129357651, -0.269889832, 0, -0.365770608, -0.37498191, -0.358360231, -0.248506427, 0.14650023, 0.37887159, 0.176965848, 0.17354326, -0.325226873, -0.181757286, -0.106706172, 0.91187042, -0.226589218, -0.249176517, -0.327948064, 1.47830939, 0.429619044, -0.0140544781, -0.178744689, -0.373765886, 0.494630933, 3.45597434, -0.303548127, -0.335214674, 0.0776511356, 0, -0.00296207191, -0.321812063, -0.144757122, -0.0673285127, -0.08834102, 1.14251733, 0, -0.373413891, -0.374932706, -0.355850965, 0, -0.250359714, -0.230273485, 0, 0.573445499, -0.0755452216, -0.327953696, -0.299652666, -0.204559296, 0.124926873, -0.0796970055, 0.508634329, 0.343236327, -0.309267163, -0.330825031, -0.148345202, -0.345975965, 2.70264816, -0.300700963, 1.25490904, -0.290433198, -0.235444471, 0.708340883, 0, 0, -0.338990331, -0.108179145, 0, 0.330748886, 0.141021758, -0.365473658, -0.323876321, -0.232124, 0.65806, -0.113367632, -0.125288025, -0.31612435, 0.0715957358, -0.301224023, 0, -0.374964267, 1.38861537, 0.431314707, 0.204647779, 0.440529495, -0.374164045, 1.22861564, -0.210627958, 1.11400461, 0, -0.237563983, -0.301669925, -0.140183389, 0.185357556, 0.130517602, 0.470116079, 1.36140692, -0.315247148, 0.971405268, -0.360693395, -0.371022016, -0.169457436, -0.373058826, -0.320014209, 0.405216038, -0.35190767, 0.603311896, 0.621826768, 0.081108205, -0.236835942, 0.275414526, -0.258930147, -0.300386369, 1.0256691, -0.0370019, -0.301128268, -0.374674648, -0.371480793, -0.342472613, 0.416975, -0.286603659, 0.226138741, -0.0936435908, 0, 0.145606115, -0.367535651, -0.129422575, -0.367773235, 0.00871928129, -0.362319797, -0.281953126, -0.369201809, -0.0906809866, -0.16964294, -0.122031063, 0, 0, -0.314260364, -0.0667479336, -0.31278491, -0.349318057, 0.0404607058, -0.371416062, 0, -0.206386298, -0.240595, -0.316480488, 1.34719038, -0.266273081, -0.0536567867, -0.374395281, -0.192077249, -0.173604518, 0.310344845, 0.424872041, -0.106260248, -0.016005937, 0.0924703181, 1.10520852, -0.0804539546, -0.3570095, -0.00116682937, -0.0601778813, -0.374204159, -0.287283242, -0.344932675, 0, 0.577019155, 1.50829518, -0.0712939873, -0.0816048086, -0.158930689, -0.284999371, 0.0982456058, -0.374565601, 0, -0.361444205, -0.221437693, -0.16651547, -0.281253695, -0.213611081, 0, 0.0771392435, -0.370949984, -0.32044825, 0, 0.433706433, 3.68710327, -0.1113974, -0.361359626, -0.339414746, 1.42489672, 0.0959750265, -0.183726102, -0.294733763, -0.368426085, -0.258638144, 0.128513142, -0.280850261, -0.318995029, 0.804492, -0.122484252, 1.13671935, -0.116544574, -0.177895248, -0.373285085, -0.312749922, 0, 2.18580413, -0.240310192, 0.186148241, 0, 0.424920768, -0.208379924, -0.316444397, 0.153025687, -0.359698236, 1.47116959, -0.364309877, -0.229463398, 0.747753322, -0.366780072, -0.304715842, 0.173081964, -0.36685276, -0.358673096, -0.348957956, -0.371121585, -0.0251094662, -0.36057815, -0.0197151117, -0.198276356, 0, -0.344330609, -0.310999304, 1.50880241, -0.358402729, 0.397525907, -0.0458498485, -0.238357976, -0.230345964, 1.6092031, -0.143442243, -0.194635063, -0.139838472, 1.0924722, -0.114864655, -0.315608472, 0.0383046195, 0, -0.22884053, -0.374883324, -0.316185355, 0.293395847, 0.784960389, 0.985001087, 0.252423495, 1.59441519, 0.0799167305, 0, 1.24076056, 1.78028929, 0.741119266, 0.0871678367, -0.0634505153, 0.321978271, 0.323188186, -0.176083133, -0.374786019, 0.887412727, 0, 0.764881, -0.295098871, 0.0701800734, 0.323322266, 0.326649696, -0.0645366758, -0.357801557, 0.00988693908, 0.0271976627, -0.186313078, 1.45519781, -0.33403632, -0.370875448, -0.166274682, 1.77701533, 0.186848715, 0.636598408, -0.26212576, -0.278095156, -0.205881834, -0.331201673, -0.34102118, 1.16390979, -0.37435618, 0, 0.497965872, 0.162276357, -0.037973471, -0.12908797, -0.0110590067, -0.259064496, 0.17460461, -0.29388383, 1.22051096, 0, -0.0260772258, 0.10353747, -0.327184469, -0.181645632, 0.0679662451, -0.351106942, 0.3905904, -0.26354149, -0.367240489, -0.0453233533, 0.0353909172, -0.367487162, 1.81205642, 0.360764652, 0.199900687, 0.00332159386, 0.316841066, -0.351864398, -0.18922998, 0, 0.675219357, -0.0567480922, -0.169213906, -0.248295575, -0.354184389, -0.309182346, -0.348137498, -0.16614756, 1.43068635, -0.0202286467, -0.134760737, -0.359458745, 1.16673827, 0.13462393, 2.48627734, 1.10418892, -0.169427305, -0.321748286, 2.30733156, 0.0568676777, -0.346899033, 0, 0.923143208, -0.37229678, -0.221425161, -0.0890953541, -0.374871403, -0.250695705, 0.323440492, 0.791041732, 0.0512185767, -0.350383699, 0.331664324, 0.907567739, 0.745236695, 0.756046, -0.281625956, 0.166676506, -0.343358725, -0.0612001084, -0.113913327, -0.302939147, 0, 1.37749672, 0, -0.37451604, -0.194880322, -0.373887479, 0.755452335, -0.0303157493, -0.35246253, 0.74564749, -0.370095551, 0, -0.240328759, 0, -0.373345703, -0.361746252, 0.165627614, 0.135090083, 0.993100822, 0.370513201, -0.355477631, 0.0335254818, -0.374432862, -0.274188876, -0.346008599, 0.579151392, 0.174890473, 0.3602193, -0.370454162, 0, -0.278309375, -0.339108855, -0.252456665, -0.294945, 0, 1.03792846, 0.718028784, -0.205817312, -0.255916595, 3.39664292, -0.0838332623, 0, -0.283746421, -0.370171249, -0.349608183, 0.504596472, -0.251878172, 0, 1.88771427, -0.107704185, -0.362070858, -0.364435792, 0, 0.296738327, 0.495566398, 0.0335875452, -0.0900539607, 0.553674757, 0.611192, -0.365091622, -0.343392044, 0.0115108481, 1.09291351, -0.15890637, 0.0692443252, -0.275814742, 0.397567868, -0.20711866, 1.59997499, -0.30341953, -0.131297246, 0, 0.0869248807, 0, -0.326364636, -0.310256451, 0.410934895, 0.807510138, 0.88503933, -0.293629318, -0.344207853, 0, -0.305390149, 0.0159551576, -0.371674567, -0.372968733, 2.83723903, -0.306744695, -0.300654948, 0.794894576, -0.0515366, -0.368801177, 0.126526952, 0.0800032243, 0.18503654, -0.122588746, -0.368767, 0.627205253, -0.324024945, 0.125648975, -0.258421302, 0, -0.307494462, 0, 0, 0.727103293, 1.2725668, 0.266542703, 0.472899914, 0.0883806869, 0, 0, 1.03631067, -0.283673525, 0.0341724455, -0.355162293, 0.059971191, -0.335024118, -0.345891744, 0, 2.75626206, -0.277259648, -0.0778444558, -0.367921501, -0.295522779, -0.361253202, -0.22202158, -0.36659345, 0.716754913, 2.68209291, -0.287703961, 0.171655834, 1.48606431, 0.541063, -0.360890716, -0.286765, -0.0488981567, 1.164644, 0, 0.705649436, 0.301493078, -0.301441222, -0.364223391, -0.374163955, -0.356642038, 1.63606954, -0.0489009209, -0.31765005, -0.0487559475, 0.0259072259, 1.08759344, 1.08655012, 0, 0.46735847, 0.24435927, 1.16309083, 0.298520535, 0, -0.302128553, 0.153347775, -0.238972634, 0.573599219, 0.0739015788, 0.00143248029, 0.713645756, -0.218442366, 0.898667216, -0.105577275, -0.305089593, 0, -0.347235411, -0.288856655, -0.350217491, 0.190373719, 0.302175343, 1.59041607, 0.366309613, 1.06642103, 0, -0.0140463095, -0.328570932, 0.0153109953, 0.261933327, -0.372927904, 0.0277475398, -0.374191165, -0.170220837, 0.335680306, -0.340576679, 0, 0.432864189, 0.291950852, -0.133833483, -0.315489978, -0.318342805, 0.657610893, -0.37499997, -0.20492135, -0.252434552, -0.268637836, 1.81550097, 1.2815448, -0.292957217, -0.367461413, 0.0536333285, -0.160143241, 1.47378719, -0.331388772, -0.357756525, 0, -0.156610906, -0.0823073089, 0.21665515, -0.343238115, 1.6829195, 0.929197907, -0.257104367, 0.180652514, -0.302034438, -0.305240959, -0.363857299, 0.674682498, 0, -0.225448757, -0.372652322, 0.645679951, -0.311841398, -0.0377834328, 0.0981506333, -0.306857526, -0.342190087, -0.373592705, 0.695392787, 0, 0.425319642, -0.369360387, -0.193700984, -0.185004801, -0.3071208, -0.22545892, -0.349206269, -0.200908884, -0.34821862, 0, 1.04973722, 0.463273793, -0.111192942, -0.357344925, -0.0638686717, -0.036353413, -0.129040122, 0, -0.274898142, 0.653502703, -0.0460345298, 0, -0.144351065, -0.364151388, -0.200325176, 0.0295563731, 0.178188518, -0.113266759, 0.394476593, -0.281178623, 0.131732389, 0.0712294132, -0.334901601, -0.0737987235, -0.163265884, 0.27926904, 0.0688242838, 0.0964225531, -0.364093721, -0.150994629, 2.078789, 0.614175916, -0.33793056, -0.319536954, 0, -0.267497748, -0.342339396, -0.243903711, -0.0660915673, -0.333001256, -0.374553472, 0.166472435, -0.373368144, -0.259940386, 0.0914090052, 1.18018007, -0.374147683, -0.141036406, 0.0590834506, -0.320597, 0.573016346, -0.36737141, -0.0504134148, 0.229502842, 0.795376837, -0.178360015, 0.560775936, 0.212327212, -0.0618165247, -0.208809271, 0.10560552, -0.355294704, -0.229680791, -0.205201596, -0.355650395, 1.0968926, 1.14916706, 0.711725473, -0.23955451, -0.374729127, 0.574593306, 0.705797136, 0.326931089, -0.353562206, -0.0664012581, -0.34104991, 0.021985691, -0.265266031, 0, 0.181807354, -0.131328732, -0.234461784, -0.012668076, 0.889899552, 0, 0, -0.064106144, -0.365244, 0, -0.168455377, -0.203533828, -0.208592594, -0.368884951, 0.932997227, 0, 0, -0.10920617, 0.873382211, 0.194094688, -0.238384306, 0.208526149, 0.85563159, 0.534768224, -0.27958259, 0, -0.337936193, -0.374272317, -0.338227898, 1.6043514, -0.0182729065, 0, -0.0177903492, -0.18635717, 0.381205082, -0.183553278, 0.0157326, -0.0642532334, 0.47944364, 0.718847096, -0.363804102, -0.0669475198, -0.356249213, -0.170849741, 0, 0.273678184, -0.0206555389, -0.317392766, -0.0991698951, 0.334153086, -0.156195298, -0.309759974, -0.0767459795, 0.139342904, -0.286126614, 0.0144157382, -0.133395717, 0.117695153, 0.247761771, -0.344999641, -0.371423274, -0.367082924, 0, -0.131237134, 0.031606786, 0.358804852, 0.651792288, -0.313774377, -0.374405175, -0.351178885, -0.241500482, -0.34166342, 0, -0.264389038, 0.0648360327, 0, 0, 0.194290802, 0, -0.045148544, -0.367921978, 0.522697, 0.476840824, 0.398072571, 0.854923427, 0, -0.161646053, -0.0979925245, -0.292680234, -0.350454748, 0, 0.349978507, -0.143171877, 0.8090657, 0, 0.930578947, 0, -0.216183409, 0.331640899, 0.979716122, -0.216606274, -0.364925295, -0.330434442, -0.154395133, -0.362906784, -0.254600435, 0.21118021, 0.300417453, -0.251150161, 0.466658294, -0.22125566, -0.197913691, 1.01735163, 2.08364034, 0.0660057738, -0.333099514, -0.0833975747, -0.087297149, -0.133364707, -0.355780184, 0.323540151, 0.677491426, -0.370770663, 0.41422832, 0.413244367, -0.255317, 1.02136803, 0.393509388, -0.342829376, 0.373915315, 0, 0.333083123, -0.0786307678, 0.408364266, -0.362235159, 0, -0.12645258, 2.22220039, 2.23013735, -0.0574856326, 0.0986215547, 0, 0.354635149, -0.374287486, 0, -0.34541145, 1.6006608, -0.214315981, -0.345714152, 0.401309252, -0.242294386, -0.374866605, -0.258328795, 0, -0.374668688, -0.17484951, 1.04332602, -0.313709408, -0.0939359888, -0.353711784, -0.366283685, -0.374986827, 0.43991819, 0.686522424, 0.154668778, -0.335831881, -0.128856122, 0.99341464, -0.284501046, 0, -0.358556718, -0.162483633, -0.3449184, -0.372690976, -0.2439062, 1.05430973, -0.372289896, -0.1007718, 0.0473147705, -0.356211394, -0.365839362, 0.166649491, 0, -0.327408373, -0.37259376, -0.214500725, -0.160610124, -0.259185404, -0.270522803, -0.325194716, -0.315471351, 1.26506102, -0.0670388788, -0.348945916, 0, 0.105244279, -0.148866013, -0.366763145, 0.108450405, -0.0350798704, 0.264472246, -0.312868953, 0, -0.0771678835, -0.122717977, -0.150883317, 1.39906669, -0.318901241, -0.311023533, 0.668522418, -0.299331516, 0.515779316, -0.17248477, 0.0674507394, 0.182011619, 0, 0.693831086, -0.217963591, 0.760934472, -0.344218045, 0.13744086, -0.35223034, 0, -0.36511609, 0.119609721, 0, 1.64304435, 1.59843063, -0.321545243, -0.261780143, -0.371672094, 0.288661212, 0.23704654, -0.302208781, -0.111624211, 0.550305724, -0.373740226, 1.47667277, -0.0268915314, -0.374560535, -0.0499212332, -0.365394443, 0.544165075, -0.23736985, 0.391597897, 0, 0.251850128, -0.0366007313, -0.197356418, 0.319611758, -0.0819105357, -0.314291358, -0.293934733, 0, -0.345037907, 1.94925416, -0.121753454, -0.251948923, -0.230028763, -0.0370426401, 0, -0.222621202, 0.892495811, -0.333492339, -0.0892614573, 0.321062595, 1.55069613, 0.206882626, 0.482905924, -0.374997765, -0.339523494, -0.366551578, -0.374083638, 0.397075534, -0.311736345, 0.275424063, -0.114497557, 0.754426539, -0.3660146, -0.191092983, -0.356257588, 0.429428041, 0, -0.24685815, 2.29294825, -0.0618383661, -0.0143719688, -0.37498498, -0.137109131, 0.89860785, -0.0878986195, -0.353702784, -0.187368482, -0.353606641, -0.347281098, 0.035936214, -0.0166188981, -0.33070153, -0.121546753, 0.378324419, -0.303585529, 0.0879305, -0.0274842456, 0.364948, 0.901828527, -0.283081859, -0.351237059, 0.0299428217, 0.311805, -0.325767577, 0, -0.374651879, 0.257995337, 0.281907618, -0.0138480561, -0.369531095])
//     .then(result => console.log(result));

module.exports = queryVector;